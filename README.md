# 課題３ テキストクラスタリング問題

## データセット

Doc2Vecを用いた文書のベクトル化を行ってデータセットにした。

入力としては[Sample.csv](https://github.com/ia15076/internship-coding-tasks/blob/sample/src/main/resources/Sample.csv)をパースして読み込み、doc_idカラムをラベルとして、doc_textカラムを入力センテンスとして利用した。

また、doc_textカラムについては、[kuromoji-ipadic](https://www.atilika.com/ja/kuromoji/)で形態素解析してテキストを形態素ごとに分割するとともに、それぞれの形態素を原形で置き換える前処理を行った。

![前処理](https://user-images.githubusercontent.com/19220989/66097538-b93da680-e5d9-11e9-9814-8c4db63c1e2a.png)

## アルゴリズムとクラスター数

k-means法を用いたクラスタリングを行った。パラメータは次のように設定した。

|パラメータ|値|理由|
|---|---|---|
|clusterCount(クラスタ数)|9|後述|
|maxIterationCount(最大イテレーション回数)|32|どんな値にしてもSSEにほとんど変化は見られなかったので感覚的に決定|
|distanceFunction(距離関数)|COSINE_DISTANCE|[Deeplearning4jのサポートする距離関数](https://deeplearning4j.org/api/latest/org/nd4j/linalg/api/ops/impl/accum/distances/package-summary.html)を全て試し、一番SSEの小さくなったものを採用した|

クラスタ数の決定にはエルボー法を用いた。下図にクラスタ数を増やしていったときのSSE(クラスタ内誤差平方和)の変化を示す。

![エルボー法](https://user-images.githubusercontent.com/19220989/66093707-5691de00-e5cc-11e9-8092-03d45412d43f.png)

エルボーというほど極端にグラフの線が折れ曲がるところは見つからなかったが、だいたいクラスタ数9のあたりから線の傾きが緩やかになるようだったのでクラスタ数は9に決定した。

## テスト結果

文書ベクトルをt-SNEで2次元に圧縮し、クラスタごとに色分けして各文書のdoc_idをプロットした。

![psne](https://user-images.githubusercontent.com/19220989/66093842-cf913580-e5cc-11e9-977e-d8867f179b21.png)

以下、各クラスタごとに出現回数の高いキーワードと、そのクラスタについての考察である。

### クラスタ0(魅力発信)

|キーワード|出現回数|
|---|---|
|凧|24|
|龍崎|16|
|椎茸|16|
|カッ|14|
|乾|12|
|転写|9|
|常滑|9|
|重光|9|
|花文字|8|
|大づかみ|8|
|つぶ|7|
|内沼|7|
|アレンジメント|6|
|シチュー|6|
|スクープ|6|
|杵|6|
|土岐|6|
|鶴岡|6|
|湯河原|5|
|鶴田|5|
|フクロウ|5|
|夢幻|5|
|足袋|5|
|レオン|5|
|詞章|5|
|万一|5|
|プロミス|5|
|フラワー|5|
|ポインター|5|
|執心|4|
|原木|4|
|石膏|4|
|ベストショット|4|
|豊頃|4|
|霜|4|
|売店|4|
|千客万来|4|
|脳震とう|4|
|生花|4|
|魔物|4|
|絵巻物|4|
|カラシ|4|
|シヤチハタ|4|
|二重化|4|
|トナカイ|4|
|安曇|4|
|更かす|3|
|ズボン|3|
|精機|3|
|しらす|3|
|征矢|3|
|ざら|3|
|浅利|3|
|印刷所|3|
|辛|3|
|秘事|3|
|りえ|3|
|京谷|3|
|ダダ|3|
|パテ|3|
|後退|3|
|パラノイア|3|
|裸足|3|
|黄泉|3|
|無痛|3|
|地ビール|3|
|大村|3|
|恋い焦がれる|3|
|大槇|3|
|共学|3|
|昭子|3|
|振り袖|3|
|商機|3|
|ホークス|3|
|誤訳|3|
|貴兄|3|
|魚谷|3|
|恨み|3|
|御殿場|3|
|生き|3|
|音符|3|
|十勝|3|
|タンポポ|3|
|きゅうり|3|
|ヤマタネ|3|
|民宿|3|
|男子校|3|
|コンバーター|3|
|取り柄|3|
|寝息|2|
|集まれる|2|
|取りあえず|2|
|送配|2|
|甘口|2|
|葵|2|
|呼び捨て|2|
|万里|2|
|こしょう|2|
|野市|2|
|細川|2|

青森県の工芸品である鶴凧をイノベーションするとか、日本の伝統芸能である能を現代に生かすなどの伝統の魅力の発信に向けた取り組みに関する文書が多く分類されていた他、日本への好感度の調査、お勧めのレストランの紹介文などもあった。「魅力発信」というクラスタ名をつけた。

### クラスタ1(考察)

|キーワード|出現回数|
|---|---|
|大串|15|
|港南|14|
|宇一|13|
|弘道|12|
|連弾|12|
|真藤|12|
|社協|11|
|守雄|11|
|おさん|9|
|つくだ煮|9|
|屋良|8|
|月森|8|
|東映動画|7|
|少林寺|6|
|見川|6|
|ガイダンス|6|
|晴子|6|
|新田|6|
|ダイエー|6|
|美少年|6|
|石灰石|6|
|しずか|5|
|うさ|5|
|多神教|5|
|藩校|5|
|プラズマ|5|
|角膜|5|
|鍋島|5|
|公家|5|
|方眼|5|
|パオス|5|
|ヒスパニック|5|
|コニシ|5|
|藪下|4|
|苫小牧|4|
|緑川|4|
|会読|4|
|父上|4|
|アウンサンスーチー|4|
|黄河|4|
|宝探し|4|
|日動|4|
|金華|4|
|アルト|4|
|学習院大学|4|
|玉代|4|
|ストライク|4|
|東急ハンズ|4|
|松坂|4|
|河出|4|
|ガブリエラ|3|
|水森|3|
|歌い手|3|
|美里|3|
|お守り|3|
|陣営|3|
|なむ|3|
|祥子|3|
|銅像|3|
|独り|3|
|たえず|3|
|給湯|3|
|ハチミツ|3|
|ウォール街|3|
|慶子|3|
|ケベック|3|
|シルビア|3|
|浮気|3|
|ラガー|3|
|自白|3|
|瓶詰|3|
|たまごっち|3|
|日本電信電話|3|
|真之|3|
|青山学院|3|
|平井|3|
|寺田倉庫|3|
|一人物|3|
|次兄|3|
|エイチ・アイ・エス|3|
|朝会|3|
|灯す|3|
|イートン|3|
|ルーズリーフ|3|
|杣口|3|
|リハビリテーション|3|
|帝|3|
|白蛇|3|
|ビデオ・リサーチ|3|
|抑留|3|
|音色|3|
|北大|3|
|持ち株|3|
|加湿|3|
|中竹|3|
|殿様|3|
|サーバ|3|
|重信|3|
|不衛生|3|
|鬼ケ島|3|

「英語学習ではとりあえず話してみるというのが大事だから、大阪のおばちゃんを参考にすれば良いのではないか」とか、「カフェのヒットの秘訣は世の中の流行に乗らないことだと思う」とか、「生活者の行動に企業の魅力はどのように関係するのか調査した」など、(特にグローバル化とか、広告に関する)考察や調査を扱った文書が多く分類されていた。クラスタ名は「考察」とした。

### クラスタ2(人物)

|キーワード|出現回数|
|---|---|
|大島紬|14|
|須藤|13|
|男鹿|12|
|前庭|11|
|義肢|10|
|ダルマ|9|
|領収|8|
|宮原|8|
|告文|7|
|高柳|7|
|里親|7|
|大前|6|
|アオイ|6|
|ライヴ|6|
|ワンタッチ|6|
|市原|6|
|あんず|6|
|奄美|6|
|接収|6|
|漆|6|
|金山|5|
|臼井|5|
|美佐|5|
|関東軍|5|
|吹雪|5|
|内耳|5|
|サミー|5|
|寝室|5|
|奉天|4|
|ラクダ|4|
|レンタルビデオ|4|
|真田|4|
|トルソー|4|
|事績|3|
|正臣|3|
|ポカポカ|3|
|しら|3|
|河本|3|
|郷|3|
|宰相|3|
|コモ|3|
|印籠|3|
|外人|3|
|かたわら|3|
|増殖|3|
|江部|3|
|元通り|3|
|輪島|3|
|渦巻|3|
|妻子|3|
|焼夷弾|3|
|別姓|3|
|丙|3|
|ならす|3|
|パイル|3|
|はける|3|
|平民|3|
|井桁|3|
|三半規管|3|
|柴山|3|
|アーニー|3|
|有り余る|3|
|宣撫|3|
|ペリー|3|
|メディカル|2|
|画伯|2|
|里子|2|
|画商|2|
|俊一郎|2|
|名将|2|
|バケーション|2|
|つぐ|2|
|澁谷|2|
|ポーラ|2|
|グラミー|2|
|萩野|2|
|仕分ける|2|
|後継ぎ|2|
|ハワイアン|2|
|ワタナベ|2|
|ラマ|2|
|ダライ|2|
|楽土|2|
|テレビ大分|2|
|修める|2|
|外堀|2|
|尻目|2|
|薬物|2|
|黒枠|2|
|詩情|2|
|好信|2|
|山男|2|
|保太郎|2|
|信ぴょう|2|
|皮下|2|
|告示|2|
|語数|2|
|炸裂|2|
|解約|2|
|ひと目|2|

「松本豊三、森崎實に続く満州帰りの逸材として、小谷重一の名も忘れることができない」だとか、「廣田周作さんの著書発売を記念し…」など、特定の人物にフォーカスした文書が多く分類されていた。クラスタ名は「人物」とした。

### クラスタ3(課題解決)

|キーワード|出現回数|
|---|---|
|長沼|19|
|ゲキ|12|
|イクラ|11|
|ルージュ|10|
|ミラクル|10|
|テンプ|8|
|望遠鏡|7|
|鬼塚|6|
|公営|6|
|バーバリ|6|
|早乙女|6|
|大槌湾|6|
|拘留|6|
|ミルボン|6|
|葛西|5|
|簿記|5|
|山砲|5|
|雑草|5|
|ストラクチャー|5|
|織部|5|
|琴子|5|
|鷲尾|5|
|しゃも|4|
|甲板|4|
|墓碑銘|4|
|自炊|4|
|留目|4|
|電流|4|
|目印|4|
|しゃくなげ|4|
|ねじれ|4|
|ヒロシ|4|
|仲川|4|
|吉原|3|
|嘆願|3|
|結子|3|
|シネマトグラフ|3|
|キューバ|3|
|生島|3|
|お布施|3|
|高井|3|
|水盤|3|
|甘栗|3|
|サク|3|
|桝田|3|
|決起|3|
|春夫|3|
|星座|3|
|アイロン|3|
|美加|3|
|凄惨|3|
|菊地|3|
|木伏|3|
|凶悪|3|
|河川敷|3|
|買い付け|3|
|笠智|3|
|処断|3|
|群島|3|
|知世|3|
|豪商|3|
|間取り|3|
|風営法|3|
|泳ぎ|3|
|肝付|3|
|ガラス瓶|3|
|マルクス|3|
|朕|3|
|内覧|3|
|実働|3|
|戦記|3|
|栖原|3|
|久田|3|
|サテン|3|
|着脱|3|
|かさばる|3|
|千歳空港|3|
|玄米|3|
|シャケ|3|
|大安売り|3|
|実数|3|
|Ｓ|3|
|いっちょ|3|
|栄枯|2|
|ズルズル|2|
|ユナイテッド|2|
|グレート|2|
|しおり|2|
|甘んじる|2|
|取り替える|2|
|山原|2|
|関東学院大学|2|
|魔法びん|2|
|おそろい|2|
|校歌|2|
|いし|2|
|山地|2|
|一難|2|
|リンカーン|2|
|釈放|2|

「サラリーマンにとってつらい朝を楽しくポジティブなものにする」、「出産後の就業はまだまだ厳しい」、「広告の出し方や組み合わせ方を考えていく必要がある」など、(主に現代の)課題を解決する手法を探った文書が多く分類されていた。クラスタ名は「課題解決」とした。

### クラスタ4(若者)

|キーワード|出現回数|
|---|---|
|塩谷|21|
|アベック|21|
|ふぐ|13|
|赤十字|12|
|熱傷|10|
|太華|10|
|桑名|10|
|ゼビオ|9|
|駅長|9|
|気球|8|
|ばね|7|
|ドラマツルギー|5|
|軟体動物|5|
|クシ|5|
|ダイワハウス|5|
|タマ子|5|
|中継ぎ|5|
|急げる|5|
|＿|5|
|すず|4|
|ミット|4|
|名札|4|
|脇田|4|
|館長|4|
|ヨット|4|
|井出|4|
|筑波|4|
|報道局|4|
|夜討ち|4|
|取りやめる|3|
|考課|3|
|基板|3|
|剥がれる|3|
|ベア|3|
|薬剤師|3|
|岩瀬|3|
|コンパニオン|3|
|憮然|3|
|新着|3|
|モナ・リザ|3|
|仮面ライダー|3|
|フランクフルト|3|
|日本ハム|3|
|高雄|3|
|税関|3|
|下浜|3|
|朝駆け|3|
|両派|3|
|枕|3|
|本橋|3|
|中畑|3|
|先進地|3|
|びらき|3|
|音量|3|
|北朝鮮|2|
|アンコール|2|
|格付け|2|
|かね|2|
|さしはさむ|2|
|尾形|2|
|アプリオリ|2|
|間瀬|2|
|のら|2|
|ひま|2|
|パッチワーク|2|
|水町|2|
|アメリカズカップ|2|
|牛久保|2|
|剥離|2|
|引きちぎる|2|
|旭化成|2|
|言い換え|2|
|褒章|2|
|勇退|2|
|この先|2|
|福建|2|
|散らかる|2|
|紛らわしい|2|
|ちゃんぽん|2|
|くり返し|2|
|肉体美|2|
|計時|2|
|凸版印刷|2|
|グリップ|2|
|大南|2|
|坂部|2|
|大坪|2|
|リポーター|2|
|高木|2|
|借用|2|
|寓話|2|
|低速|2|
|麻理|2|
|合い方|2|
|ほぐれる|2|
|積み残す|2|
|軍歌|2|
|おっくう|2|
|長野朝日放送|2|
|秘書官|2|

若者の行動調査やSNSの分析、若い女性のインフルエンサーのプロデュースなど、若者に関する文書が多く分類されていた。クラスタ名は「若者」とした。

### クラスタ5(未来)

|キーワード|出現回数|
|---|---|
|新政|18|
|蜷川|16|
|犀川|15|
|みうら|11|
|ハンドボール|11|
|谷川|11|
|細田|9|
|日向|9|
|ダン|8|
|粘着|7|
|酒販|7|
|タチバナ|7|
|新婦|6|
|ロップ|6|
|新郎|6|
|血小板|5|
|振袖|5|
|神棚|5|
|班長|5|
|モメント|5|
|エントロピー|5|
|忠兵衛|5|
|名古屋大学|5|
|菱屋|5|
|一升瓶|5|
|事物|5|
|緑ヶ丘|4|
|打消す|4|
|ソク|4|
|フォスター|4|
|実花|4|
|岩村|4|
|薬用|4|
|転売|4|
|課徴|4|
|アール|4|
|殺る|4|
|吊り橋|4|
|カカオ|4|
|投射|4|
|書家|4|
|矢作|4|
|創平|4|
|大輪|4|
|ヤンキー|4|
|勝又|4|
|菊池|4|
|ブロックバスター|4|
|円谷|4|
|博嗣|4|
|野原|4|
|ベイルート|4|
|ホーン|3|
|かめ|3|
|流体|3|
|モータースポーツ|3|
|じゅん|3|
|影絵|3|
|蒋介石|3|
|亡霊|3|
|ジェーン|3|
|折り合う|3|
|土産物|3|
|腹腔|3|
|ホバート|3|
|内々定|3|
|あしい|3|
|デッド|3|
|小道|3|
|ワーナー・ブラザーズ|3|
|エデン|3|
|凪|3|
|テロリズム|3|
|書斎|3|
|春日大社|3|
|輪転|3|
|ウインター|3|
|猛禽|3|
|保健所|3|
|ごころ|3|
|宮川|3|
|常食|2|
|栗本|2|
|些細|2|
|定款|2|
|レシーブ|2|
|沢尻|2|
|手入れ|2|
|さば|2|
|入れ|2|
|ちの|2|
|宝生|2|
|平手打ち|2|
|垂れる|2|
|聞き分け|2|
|引き連れる|2|
|ローソン|2|
|まつる|2|
|変人|2|
|しゃがむ|2|

自動運転に関する話題や、マーケティングの未来についての話、あるいは「1980年代は未来に向かって夢が描けた」という話など、将来に関する話が多く分類されていた。クラスタ名は「未来」とした。

### クラスタ6(挑戦する人)

|キーワード|出現回数|
|---|---|
|着こなし|19|
|池上線|14|
|ワニ|10|
|デュアル|9|
|道久|8|
|水上|8|
|旧暦|7|
|野良|6|
|下ごしらえ|6|
|蒲田|5|
|拳銃|5|
|徳之島|5|
|ローバー|5|
|和栗|5|
|新駅|5|
|入道|5|
|マンガン|4|
|蝶|4|
|野良犬|4|
|ウォーク|4|
|島村|4|
|ユリカ|4|
|長靴|4|
|発着|4|
|高須|4|
|磁性|4|
|水石|3|
|号機|3|
|吉池|3|
|ぜりふ|3|
|クリプトン|3|
|深川|3|
|牧口|3|
|同い年|3|
|供養|3|
|洗足|3|
|内村|3|
|矢ケ崎|3|
|こねくる|3|
|上坂|3|
|黒パン|3|
|やり口|3|
|ホームスタジアム|3|
|外需|3|
|メキシコシティ|3|
|アンプラグド|3|
|前澤|3|
|仲立ち|3|
|再認|3|
|星野|3|
|戸越|3|
|宗将|3|
|部材|3|
|佐山|3|
|キリシタン|3|
|ホルスト|2|
|一軍|2|
|水晶|2|
|露天風呂|2|
|薄型|2|
|野嶋|2|
|梅川|2|
|釜山|2|
|勘ぐる|2|
|河島|2|
|濃縮|2|
|大脳皮質|2|
|パンタロン|2|
|ジュール|2|
|無地|2|
|健三|2|
|子守り|2|
|田安|2|
|じわっ|2|
|伊集院|2|
|駒澤|2|
|めど|2|
|雅也|2|
|達雄|2|
|清める|2|
|テレビ山梨|2|
|筒抜け|2|
|鎌|2|
|福屋|2|
|高品|2|
|立方体|2|
|食い合う|2|
|生化学|2|
|肉薄|2|
|ノーギャラ|2|
|ぶち壊す|2|
|保正|2|
|上士幌|2|
|メモリ|2|
|伝言板|2|
|はなせる|2|
|ツル|2|
|パチ|2|
|みのり|2|
|やらかす|2|

他に比べてこれといった特徴の少ないクラスタだったが、強いて言うなら世の中にないモノを創り出す挑戦をしている人のことだとか、「虹を創るお手伝い」をしている人のことなど、何かに挑戦する個人を扱った話が多く分類されていた。他のクラスタとやや被るが、クラスタ名は「挑戦する人」とした。

### クラスタ7(オールドファッション)

|キーワード|出現回数|
|---|---|
|高草木|8|
|マンドリン|8|
|鯖江|7|
|婦人画報社|7|
|ドロ|6|
|星川|6|
|西台|6|
|解凍|5|
|マルク|5|
|森岡|5|
|別件|5|
|茂木|5|
|髑髏|5|
|紀北|5|
|イメージスケッチ|5|
|アク|4|
|ネギ|4|
|薄力粉|4|
|詩的|4|
|カイロ|4|
|なぎさ|4|
|公聴|4|
|入荷|4|
|徒|4|
|櫻田|4|
|三菱|4|
|出金|4|
|はなやか|3|
|ダーバン|3|
|水玉|3|
|大当たり|3|
|今西|3|
|オイルショック|3|
|巨人軍|3|
|追い出す|3|
|新任|3|
|女々しい|3|
|茶会|3|
|里谷|3|
|トホホ|3|
|ピーター|3|
|深田|3|
|真庭|3|
|麺類|3|
|宇多田|3|
|生きぬく|3|
|義手|3|
|手裏剣|3|
|ヒヨコ|3|
|含み|3|
|謎謎|3|
|ゴキブリ|3|
|三菱信託銀行|3|
|客人|3|
|強力粉|3|
|馬力|3|
|祝|3|
|フレーク|3|
|受け付け|2|
|ジャッド|2|
|単細胞|2|
|反戦|2|
|鉄分|2|
|九谷|2|
|下院|2|
|すり減らす|2|
|半生|2|
|破線|2|
|電通北海道|2|
|ウェディング|2|
|ゴールイン|2|
|阪急|2|
|カトリック|2|
|片栗粉|2|
|秋吉|2|
|居残る|2|
|トロント|2|
|冷え|2|
|実線|2|
|三菱自動車|2|
|ヒマ|2|
|変則|2|
|ブイ|2|
|ベラ|2|
|鮪|2|
|森村|2|
|がっしり|2|
|外商|2|
|スカッシュ|2|
|お釣り|2|
|しゃぶしゃぶ|2|
|今頃|2|
|エスプレッソ|2|
|ヘルスセンター|2|
|堆積|2|
|浜本|2|
|新垣|2|
|雅春|2|
|急落|2|
|清塚|2|

35歳にして初めてテレビCMに手を広げた人の話、平均年齢80歳のコーラス隊の話など、ある程度の歳になって活躍する人の話、あるいは「AI化にあっても料理のレシピを考える人間はまだ必要」とか「テクノロジー全盛の時代でもノロウイルスの予防にはやっぱり手洗いが大事」など、なんとなく古いものでも活躍の余地はあるよ、というような話が多かった。クラスタ名は「オールドファッション」とした。

### クラスタ8(成長)

|キーワード|出現回数|
|---|---|
|諏訪|13|
|草鞋|13|
|ボルト|8|
|石鹸|8|
|宝くじ|8|
|飲茶|7|
|プラットホーム|7|
|日産|7|
|荒海|7|
|ほり|6|
|焚火|6|
|小塚|6|
|口実|5|
|Ｕターン|5|
|狭山|5|
|先着|5|
|コッペパン|5|
|わっぱ|5|
|血糖|5|
|友幸|4|
|ホモ|4|
|ベビーシッター|4|
|芸大|4|
|デウス|4|
|光子|4|
|米ぬか|4|
|リスキー|4|
|制動|4|
|崑|4|
|魚市場|4|
|日野|4|
|実母|3|
|武蔵|3|
|さび|3|
|エレメント|3|
|翼賛|3|
|富澤|3|
|ミツワ|3|
|覇権|3|
|有馬|3|
|舳先|3|
|卵胞|3|
|小田島|3|
|焼きそば|3|
|先制|3|
|ミュンヘン|3|
|共助|3|
|乱れ|3|
|大政|3|
|大槻|3|
|開高|3|
|福島民報社|3|
|諏訪湖|3|
|ダイオード|3|
|声紋|3|
|娑婆|3|
|通告|3|
|不妊|3|
|若田|3|
|刺客|3|
|おそい|3|
|ひな祭り|3|
|アンバー|3|
|郡上|3|
|大道|3|
|事始|3|
|買い占め|3|
|下水|3|
|有村|3|
|年率|3|
|橘|3|
|シャーベット|3|
|茅野|3|
|落水|3|
|機転|3|
|柳川|3|
|村石|3|
|戸隠|3|
|堀口|3|
|衣笠|3|
|香月|2|
|宮本|2|
|産前|2|
|芦|2|
|柳沢|2|
|紐帯|2|
|すり込む|2|
|ほうき|2|
|函館|2|
|原村|2|
|広帯域|2|
|赤裸々|2|
|各層|2|
|揺らめく|2|
|はみ|2|
|ダウン症|2|
|仕上り|2|
|ラップタイム|2|
|わび|2|
|オートキャンプ|2|

「日頃から多くの知識を吸収すべき」とか「自分の年齢に合わせてステップアップできお婆ちゃんになっても仕事が出来る組織になりたい」など、(個人に限らず組織のことでも)成長について扱った文書が多く分類されていた。クラスタ名は「成長」とした。

## コード実行手順

動作環境：Java(>=8), Maven 3

以下はクラスタリングを実行する手順。
散布図のプロットにはPlotter.javaを、キーワードのリストアップにはKeywordsLister.javaをコンパイルして実行する。

1. このブランチをclone

```
git clone -b sample https://github.com/ia15076/internship-coding-tasks.git
```

2. コンパイル

```
cd internship-coding-tasks
mvn compile
```

3. 実行

```
mvn exec:java
```
